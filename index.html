<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSIC DNA - Á©∂Ê•µ„ÅÆÈü≥Ê•ΩÂ±ûÊÄßË®∫Êñ≠</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root { --bg: #050505; --card-inner: #121212; --accent-l: #6366f1; --accent-r: #ec4899; --text: #ffffff; --text-dim: #a1a1aa; }
        body { font-family: "Inter", "Hiragino Kaku Gothic ProN", sans-serif; background-color: var(--bg); color: var(--text); margin: 0; overflow-x: hidden; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 60px 0 40px; }
        header h1 { font-size: 2rem; letter-spacing: 6px; font-weight: 900; margin: 0; background: linear-gradient(90deg, var(--accent-l), var(--accent-r)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        #loading-status { text-align: center; font-size: 0.7rem; color: #4ade80; margin-top: 10px; height: 1em; }

        .question-wrapper { display: flex; flex-direction: column; gap: 20px; margin-bottom: 60px; }
        .q-container { background: var(--card-inner); border-radius: 20px; padding: 25px; border: 1px solid #27272a; }
        .q-header { font-size: 0.7rem; color: var(--text-dim); margin-bottom: 15px; display: block; text-align: center; letter-spacing: 2px; }
        .choice-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .choice-btn { background: #18181b; border: 2px solid #27272a; color: white; padding: 15px 10px; border-radius: 12px; cursor: pointer; font-size: 0.8rem; transition: 0.2s; min-height: 80px; }
        .choice-btn.active { border-color: var(--accent-l); background: rgba(99, 102, 241, 0.1); }

        .analyze-btn { width: 100%; max-width: 300px; background: white; color: black; border: none; padding: 20px; border-radius: 50px; font-size: 1rem; font-weight: 900; cursor: pointer; display: block; margin: 0 auto 100px; }
        .analyze-btn:disabled { background: #27272a; color: #52525b; }

        #result-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; overflow-y: auto; padding: 20px 10px; box-sizing: border-box;}
        #capture-area { background: #fff; color: #000; border-radius: 32px; overflow: hidden; width: 100%; max-width: 400px; margin: 0 auto; }
        .card-top { background: #000; padding: 30px 20px; text-align: center; color: white; }
        .card-content { padding: 30px 25px; text-align: center; }
        .res-title { font-size: 1.4rem; font-weight: 900; color: #000; margin-bottom: 10px; line-height: 1.2; }
        .res-desc { font-size: 0.85rem; color: #4b5563; margin-bottom: 25px; }

        .artist-tag-box { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; }
        .artist-chip { background: #f3f4f6; padding: 5px 12px; border-radius: 50px; font-size: 0.7rem; font-weight: 700; color: #1f2937; border: 1px solid #e5e7eb; }
        .match-perfect { background: #000; color: #fff; border-color: #000; }

        .action-container { width: 100%; max-width: 400px; margin: 20px auto; display: flex; flex-direction: column; gap: 12px; }
        .save-btn { background: var(--accent-l); color: white; border: none; padding: 18px; border-radius: 16px; font-weight: 800; cursor: pointer; }
        .sns-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .sns-btn { padding: 12px; border-radius: 12px; text-decoration: none; color: white; font-size: 0.7rem; font-weight: 800; text-align: center; border: 1px solid rgba(255,255,255,0.2); }
        .x-btn { background: #111; }
        .ig-btn { background: linear-gradient(45deg, #f09433, #bc1888); }
        .retry-text { text-align: center; color: var(--text-dim); font-size: 0.7rem; margin-top: 20px; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>MUSIC DNA</h1>
        <div id="loading-status">Loading Data...</div>
    </header>
    <div class="question-wrapper" id="q-list"></div>
    <button id="analyze-btn" class="analyze-btn" disabled onclick="showResult()">ÂàÜÊûê„ÇíÈñãÂßã„Åô„Çã</button>
</div>

<div id="result-overlay">
    <div id="capture-area">
        <div class="card-top">
            <div style="font-size: 0.5rem; letter-spacing: 3px; color: #71717a;">MUSIC DNA REPORT</div>
            <div style="font-size: 1rem; font-weight: 900; margin-top: 5px;">CERTIFIED LISTENER</div>
        </div>
        <div class="card-content">
            <div id="res-title" class="res-title">-</div>
            <p id="res-desc" class="res-desc">-</p>
            <div style="font-size: 0.5rem; font-weight: 800; color: #9ca3af; letter-spacing: 2px; margin-bottom: 10px;">DNA MATCH ARTISTS</div>
            <div id="artist-match-list" class="artist-tag-box"></div>
        </div>
    </div>
    <div class="action-container">
        <button class="save-btn" onclick="saveAsImage()">üì∏ ÁµêÊûú„ÇíÁîªÂÉè„Åß‰øùÂ≠ò„Åô„Çã</button>
        <div class="sns-grid">
            <a id="share-x" href="#" target="_blank" class="sns-btn x-btn">X„Åß„Ç∑„Çß„Ç¢</a>
            <a href="https://www.instagram.com/" target="_blank" class="sns-btn ig-btn">Instagram</a>
        </div>
        <div class="retry-text" onclick="location.reload()">„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë®∫Êñ≠„Åô„Çã</div>
    </div>
</div>

<script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRRyt_I_8kDlfPnMSxsVSYBcytr3ur76vs7xmF30t01RFQUkAlULzF8P1oLlsFdLcyMZrQCMj3PAANV/pub?output=csv';
    
    const questions = [
        { a: "ÁàÜÈü≥„ÅÆ„É≠„ÉÉ„ÇØ„ÅßËß£Êîæ„Åï„Çå„Åü„ÅÑ", b: "‰∏ÄÁ∑í„Å´Ê≤à„Çì„Åß„Åè„Çå„ÇãÊõ≤„Å´Êïë„Çè„Çå„Åü„ÅÑ", catA: "energy", catB: "deep" },
        { a: "„É©„Ç§„Éñ„ÅßÁõõ„Çä‰∏ä„Åå„Çã„Éä„É≥„Éê„Éº", b: "„ÅäÊ¥íËêΩ„ÅßÊ¥óÁ∑¥„Åï„Çå„Åü„ÉÅ„É´„Å™ÊôÇÈñì", catA: "energy", catB: "aesthetic" },
        { a: "Ê≠åË©û„ÇíÂôõ„ÅøÁ∑†„ÇÅÊ∑±„ÅèËÄÉÂØü„Åó„Åü„ÅÑ", b: "Á©∫Èñì„ÇíÂΩ©„ÇãÈüø„Åç„Å´ÈÖî„ÅÑ„Åó„Çå„Åü„ÅÑ", catA: "deep", catB: "aesthetic" },
        { a: "Ë§áÈõë„Å™ÊßãÊàê„Å´ËÑ≥„Åå„Çæ„ÇØ„Çæ„ÇØ„Åô„Çã", b: "Áõ¥ÊÑüÁöÑ„Å™„Éë„ÉØ„Éº„Å´‰Ωì„ÅåÂãï„Åè", catA: "skill", catB: "energy" },
        { a: "Ê•ΩÂô®Âçò‰Ωì„ÅÆÂáÑ„Åï„ÇíËÅ¥„ÅçËæº„Åø„Åü„ÅÑ", b: "„Éú„Éº„Ç´„É´„ÇÑÂÖ®‰Ωì„ÅÆÈõ∞Âõ≤Ê∞ó„ÅåÂ§ß‰∫ã", catA: "skill", catB: "aesthetic" },
        { a: "ÂÆåÁíß„Å™„Ç§„É≥„Éà„É≠„Åã„ÇâÂßã„Åæ„Çä„Åü„ÅÑ", b: "Áâ©Ë™û„ÅÆ‰ΩôÈüª„Å´Ê∑±„ÅèÊµ∏„Çä„Åü„ÅÑ", catA: "skill", catB: "deep" },
        { a: "Ê≠£‰Ωì‰∏çÊòé„Å™ÊâçËÉΩ„ÇíË¶ã„Å§„Åë„Åü„ÅÑ", b: "ÂúßÂÄíÁöÑ„Å™ÁÜ±Èáè„ÇíÊîæ„Å§„Çπ„Çø„Éº„ÅåÂ•Ω„Åç", catA: "dig", catB: "energy" },
        { a: "ÁÑ°Âêç„ÅÆ„Ç§„É≥„Éá„Ç£„Éº„Ç∫„ÇíÊéò„Çä„Åü„ÅÑ", b: "Ê¥óÁ∑¥„Åï„Çå„ÅüÊúÄÊñ∞„Éà„É¨„É≥„Éâ„ÇíÊµ¥„Å≥„Åü„ÅÑ", catA: "dig", catB: "aesthetic" },
        { a: "Â∏∏„Å´Êñ∞„Åó„ÅÑÂà∫ÊøÄ„ÇíÊéò„ÇäÁ∂ö„Åë„Åü„ÅÑ", b: "ËÅ∑‰∫∫Ëä∏„ÅÆ„Çà„ÅÜ„Å™ÊºîÂ•è„ÇíÂ†™ËÉΩ„Åó„Åü„ÅÑ", catA: "dig", catB: "skill" },
        { a: "Èõ®„ÅÆÊó•„ÇÑÊ∑±Â§ú„Å´‰∏Ä‰∫∫„ÅßÊµ∏„ÇãÈü≥Ê•Ω", b: "Êô¥Â§©„ÅÆ„Éâ„É©„Ç§„Éñ„Å´ËÉå‰∏≠„ÇíÊäº„ÅôÈü≥Ê•Ω", catA: "deep", catB: "energy" },
        { a: "Ê•ΩÂô®„ÅÆ„ÉÜ„ÇØ„Éã„ÉÉ„ÇØ„Å´ÊÉπ„Åã„Çå„Çã", b: "Â≠§Áã¨„ÇÑËëõËó§„Åå‰ºù„Çè„ÇãÁîü„ÄÖ„Åó„ÅÑÊ≠å", catA: "skill", catB: "deep" },
        { a: "„Éà„Éº„Çø„É´„Å™ÁæéÂ≠¶„Åå„ÅÇ„Çã‰∫∫„ÅåÂ•Ω„Åç", b: "Èü≥Ê•Ω„Åù„ÅÆ„ÇÇ„ÅÆ„ÅÆÁï∞Ë≥™„Åï„ÅåÂ•Ω„Åç", catA: "aesthetic", catB: "dig" },
        { a: "ÁàÜÁô∫ÁöÑ„Å™ÂÖÉÊ∞ó„Çí„ÉÅ„É£„Éº„Ç∏„Åó„Åü„ÅÑ", b: "ÂÑ™ÈõÖ„ÅßÂøÉÂú∞„Çà„ÅÑÂÆâ„Çâ„Åé„Åå„Åª„Åó„ÅÑ", catA: "energy", catB: "aesthetic" },
        { a: "ÂøÉ„ÇíÊè∫„Åï„Å∂„Çã„ÅÆ„ÅØ„ÄåÈ≠Ç„ÅÆÂè´„Å≥„Äç", b: "ÂøÉ„ÇíÊè∫„Åï„Å∂„Çã„ÅÆ„ÅØ„ÄåÈü≥„ÅÆÊßãÁØâÁæé„Äç", catA: "deep", catB: "skill" },
        { a: "„ÄåËá™ÂàÜ„Å†„Åë„ÅåÁü•„Çã„ÄçÁâπÂà•ÊÑü„ÅåÂ§ß‰∫ã", b: "„Äå„Åø„Çì„Å™„ÅßÁÜ±„Åè„Å™„Çã„Äç‰∏Ä‰ΩìÊÑü„ÅåÂ§ß‰∫ã", catA: "dig", catB: "energy" }
    ];

    const titleMap = {
        "energy_skill": ["Ë∂ÖÁµ∂ÊäÄÂ∑ß„ÅÆÁÜ±ÁãÇÁöÑ„Éû„Ç®„Çπ„Éà„É≠", "ÊøÄ„Åó„Åï„ÅÆ‰∏≠„Å´„ÅÇ„ÇãÁ∑ªÂØÜ„Å™ÊäÄË°ì„ÇÑÊßãÊàê„ÅÆÂáÑ„Åï„ÇíË¶ãÊäú„ÅèËÄ≥„ÅÆÊåÅ„Å°‰∏ª„ÄÇ"],
        "energy_dig": ["ÊúÄÂâçÁ∑ö„ÇíÁÑº„ÅèÁàÜÈü≥„Éè„É≥„Çø„Éº", "Âà∫ÊøÄ„Å®ÁÜ±ÁãÇ„ÇíÊ±Ç„ÇÅ„Å¶„ÄÅÊú™Áü•„ÅÆÊâçËÉΩ„ÇíÊéò„ÇäÁ∂ö„Åë„ÇãÈñãÊãìËÄÖ„ÄÇ"],
        "energy_deep": ["È≠Ç„ÇíÈúá„Çè„Åõ„ÇãÊÉÖÁÜ±„ÅÆ‰ª£ÂºÅËÄÖ", "Êòé„Çã„ÅÑÊõ≤„ÅÆ‰∏≠„Å´„ÇÇÊ∑±„ÅÑ„É°„ÉÉ„Çª„Éº„Ç∏ÊÄß„ÇíÊ±Ç„ÇÅ„ÄÅÂÖ®Âäõ„ÅßÊÑüÊÉÖÁßªÂÖ•„Åô„Çã„ÄÇ"],
        "energy_aesthetic": ["ÂÖâ„ÇäËºù„Åè„Çπ„ÉÜ„Éº„Ç∏„ÅÆÁõÆÊíÉËÄÖ", "Ê¥æÊâã„Å™„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇÑÊ¥óÁ∑¥„Åï„Çå„ÅüÁæéÂ≠¶„ÇíÊÑõ„Åô„Çã„ÄÇ"],
        "deep_skill": ["Ê∑±Ê∑µ„ÇíË®≠Ë®à„Åô„ÇãÈü≥ÈüøÂì≤Â≠¶ËÄÖ", "Áâ©Ë™ûÊÄß„ÇíÂ§ß‰∫ã„Å´„Åó„Å§„Å§„ÄÅ„Åù„ÅÆË£è„Å´„ÅÇ„ÇãË§áÈõë„Å™Èü≥„ÅÆÈáç„Å™„Çä„ÇíÂàÜÊûê„Åô„Çã„ÄÇ"],
        "deep_dig": ["„Éç„ÉÉ„Éà„ÅÆÊµ∑Â∫ï„ÇíÊºÇ„ÅÜÊÑüÊÉÖ„ÅÆË¶≥Ê∏¨ËÄÖ", "Ëá™ÂàÜ„Å†„Åë„ÅÆÂ≠§Áã¨„Å´ÂØÑ„ÇäÊ∑ª„ÅÜ„ÄÅ„Åæ„Å†Ë¶ã„Å¨Ê≠å„Çí„Éç„ÉÉ„Éà„ÅÆÂ∫ï„ÅßÊé¢„ÅóÁ∂ö„Åë„Çã„ÄÇ"],
        "deep_energy": ["ÈùôÂØÇ„ÇíÂàá„ÇäË£Ç„ÅèÂøÉ„ÅÆÈù©ÂëΩÂÆ∂", "ÂÜÖÂÅ¥„Å´Âº∑„ÅÑÁÜ±Èáè„ÇíÁßò„ÇÅ„Å¶„Åä„Çä„ÄÅ„Ç®„É¢„Éº„Ç∑„Éß„Éä„É´„Å™ÁàÜÈü≥„Å´Êïë„ÅÑ„ÇíË¶ãÂá∫„Åô„ÄÇ"],
        "deep_aesthetic": ["ÊúàÂ§ú„Å´Ê≤à„ÇÄÁæéÂ≠¶„ÅÆË©©‰∫∫", "Áæé„Åó„ÅÑË®ÄËëâÈÅ∏„Å≥„Å®Á∂∫È∫ó„Å™ÊóãÂæã„Å†„Åë„Å´Êµ∏„Çä„ÄÅËá™ÂàÜ„Å†„Åë„ÅÆ‰∏ñÁïå„Çí‰Ωú„Çã„ÄÇ"],
        "aesthetic_skill": ["ÂÆåÁíß„Å™‰ΩôÁôΩ„ÇíÂâµ„ÇãÈü≥Èüø„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„Éà", "Ê¥óÁ∑¥„Åï„Çå„ÅüÁ©∫Ê∞óÊÑü„Å®„ÄÅ„Åù„Çå„ÇíÊîØ„Åà„ÇãÈ´òÂ∫¶„Å™ÊäÄÂ∑ß„ÇíÊÑõ„Åô„Çã„ÄÇ"],
        "aesthetic_dig": ["„Éà„É¨„É≥„Éâ„ÅÆÂ¢ÉÁïå„ÇíÊ≠©„ÅèÂØ©ÁæéÂÆ∂", "Â∏∏„Å´ÊúÄÂÖàÁ´Ø„ÅÆ„Çª„É≥„Çπ„ÇíÊåÅ„Å°„ÄÅ„Ç∏„É£„É≥„É´„É¨„Çπ„Å´„Äå‰ªä„Åã„Å£„Åì„ÅÑ„ÅÑÈü≥„Äç„Çí„Ç≠„É£„ÉÉ„ÉÅ„Åô„Çã„ÄÇ"],
        "aesthetic_energy": ["ÈÆÆ„ÇÑ„Åã„Å´Ë∏ä„Çã„Ç¢„Éº„Éê„É≥„Éª„ÉÄ„É≥„Çµ„Éº", "Ê¥óÁ∑¥„Åï„Çå„Åü„Éì„Éº„Éà„ÇíÂ•Ω„Åø„ÄÅÈü≥Ê•Ω„ÅßÊó•Â∏∏„ÇíÈÆÆ„ÇÑ„Åã„Å´ÂΩ©„Çã„ÄÇ"],
        "aesthetic_deep": ["ÈªÑÊòè„Å´ÂØÑ„ÇäÊ∑ª„ÅÜ„Ç®„É¢„Éª„Éâ„É™„Éº„Éû„Éº", "Âàá„Å™„ÅÑÊ≠åË©û„Å´Âº±„Åè„ÄÅÈü≥Ê•Ω„ÇíËÅ¥„Åè„Åì„Å®„ÅßÁâ©Ë™û„ÅÆ‰∏≠„Å´Ê≤°ÂÖ•„Åó„Åü„ÅÑ‰∫∫„ÄÇ"],
        "skill_dig": ["Êú™Ë∏è„ÅÆË≠úÈù¢„ÇíËß£„ÅèÈü≥„ÅÆËß£ÊûêÂÆò", "Ë™∞„ÇÇÁúü‰ºº„Åß„Åç„Å™„ÅÑÁã¨Ëá™„ÅÆÊºîÂ•èÊäÄË°ì„ÇÑ„ÄÅÁï∞Ë≥™„Å™„Çµ„Ç¶„É≥„ÉâÊßãÊàê„Å´Âø´ÊÑü„ÇíË¶ö„Åà„Çã„ÄÇ"],
        "skill_energy": ["Á≤æÂØÜ„Å´ÁãÇ„ÅÜÊÉÖÁÜ±„ÅÆ„É°„Ç´„Éã„Ç∫„É†", "ÁêÜÊÄßÁöÑ„Åß„ÅÇ„Çä„Å™„Åå„ÇâÁÜ±„ÅÑ„ÄÇÂÆåÁíß„Å´„Ç≥„É≥„Éà„É≠„Éº„É´„Åï„Çå„ÅüÁãÇÊ∞ó„ÇíÊÑõ„Åô„Çã„ÄÇ"]
    };

    let artistMaster = [];
    let answers = new Array(questions.length).fill(null);

    async function init() {
        try {
            const res = await fetch(SHEET_URL);
            const csvText = await res.text();
            const rows = csvText.split(/\r?\n/).slice(1);
            artistMaster = rows.map(row => {
                const cols = row.split(',');
                if (cols.length < 2) return null;
                // ÂÖ®Ëßí„Ç´„É≥„Éû„ÇÑ„Éâ„ÉÉ„Éà„ÄÅÂ§ßÊñáÂ≠óÂ∞èÊñáÂ≠ó„ÄÅÁ©∫ÁôΩ„Çí„Åô„Åπ„Å¶Ê≠£Ë¶èÂåñ
                const tags = cols[1].toLowerCase().replace(/[Ôºé„ÄÇ„ÄÅ]/g, ',').split(/[,.]/).map(t => t.trim());
                return { name: cols[0].trim().replace(/^"|"$/g, ''), tags: tags };
            }).filter(a => a && a.name);
            document.getElementById('loading-status').innerText = `‚úÖ ${artistMaster.length} Artists Synced`;
        } catch(e) {
            document.getElementById('loading-status').innerText = `‚ùå Sync Failed`;
        }
        render();
    }

    function render() {
        const list = document.getElementById('q-list');
        questions.forEach((q, i) => {
            const d = document.createElement('div');
            d.className = 'q-container';
            d.innerHTML = `<span class="q-header">Phase ${i+1}</span><div class="choice-group">
                <button class="choice-btn" onclick="sel(${i},'A',this)">${q.a}</button>
                <button class="choice-btn" onclick="sel(${i},'B',this)">${q.b}</button>
            </div>`;
            list.appendChild(d);
        });
    }

    function sel(i, t, b) {
        answers[i] = t;
        Array.from(b.parentElement.children).forEach(btn=>btn.classList.remove('active'));
        b.classList.add('active');
        if(!answers.includes(null)) document.getElementById('analyze-btn').disabled = false;
    }

    function showResult() {
        let s = {energy:0, deep:0, aesthetic:0, skill:0, dig:0};
        answers.forEach((ans, i) => s[ans==='A'?questions[i].catA:questions[i].catB]++);
        const sorted = Object.entries(s).sort((a,b)=>b[1]-a[1]);
        const t1 = sorted[0][0], t2 = sorted[1][0];
        const res = titleMap[`${t1}_${t2}`] || titleMap[`${t2}_${t1}`] || ["Èü≥Ê•Ω„ÅÆÂÜíÈô∫ÂÆ∂", "Êú™Áü•„ÅÆÈü≥„ÇíÊ±Ç„ÇÅ„ÇãËÄÖ„ÄÇ"];

        document.getElementById('res-title').innerText = res[0];
        document.getElementById('res-desc').innerText = res[1];

        // „Éû„ÉÉ„ÉÅ„É≥„Ç∞Âà§ÂÆöÔºàÈñæÂÄ§„Çí‰∏ã„Åí„Å¶„Çà„ÇäÂá∫„ÇÑ„Åô„Åè‰øÆÊ≠£Ôºâ
        const matched = artistMaster.map(a => {
            let pts = 0;
            if(a.tags.some(tag => tag.includes(t1))) pts += 10;
            if(a.tags.some(tag => tag.includes(t2))) pts += 5;
            return {...a, pts};
        }).filter(a => a.pts >= 5) // 2‰Ωç„ÅÆÂ±ûÊÄß„Åå‰∏ÄËá¥„Åô„Çã„Å†„Åë„Åß„ÇÇË°®Á§∫
          .sort((a,b)=>b.pts-a.pts).slice(0, 10);

        const listContainer = document.getElementById('artist-match-list');
        if (matched.length === 0) {
            listContainer.innerHTML = '<p style="font-size:0.7rem; color:#999;">„ÅÇ„Å™„Åü„ÅÆÊÑüÊÄß„ÅØÂîØ‰∏ÄÁÑ°‰∫å„ÅÆ„Çà„ÅÜ„Åß„Åô„ÄÇ</p>';
        } else {
            listContainer.innerHTML = matched.map(a=>
                `<div class="artist-chip ${a.pts>=10?'match-perfect':''}">${a.name}</div>`
            ).join('');
        }

        document.getElementById('result-overlay').style.display = 'block';
        window.scrollTo(0,0);
    }

    async function saveAsImage() {
        const area = document.getElementById('capture-area');
        const canvas = await html2canvas(area, { backgroundColor: '#000', scale: 2 });
        const link = document.createElement('a');
        link.download = 'MUSIC_DNA.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    }

    init();
</script>
</body>
</html>
