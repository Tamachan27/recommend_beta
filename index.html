<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSIC DNA - Â±ûÊÄßË®∫Êñ≠</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root { --bg: #050505; --card-inner: #121212; --accent-l: #6366f1; --accent-r: #ec4899; --text: #ffffff; --text-dim: #a1a1aa; }
        body { font-family: "Inter", "Hiragino Kaku Gothic ProN", sans-serif; background-color: var(--bg); color: var(--text); margin: 0; overflow-x: hidden; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        header { text-align: center; padding: 60px 0 40px; }
        header h1 { font-size: 2rem; letter-spacing: 6px; font-weight: 900; margin: 0; background: linear-gradient(90deg, var(--accent-l), var(--accent-r)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .sub-guide { font-size: 0.8rem; color: var(--text-dim); margin-top: 10px; font-weight: 500; }
        #loading-status { text-align: center; font-size: 0.6rem; color: #4ade80; margin-top: 10px; height: 1em; }

        .question-wrapper { display: flex; flex-direction: column; gap: 20px; margin-bottom: 60px; }
        .q-container { background: var(--card-inner); border-radius: 20px; padding: 25px; border: 1px solid #27272a; }
        .q-header { font-size: 0.7rem; color: var(--text-dim); margin-bottom: 15px; display: block; text-align: center; letter-spacing: 2px; }
        .choice-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .choice-btn { background: #18181b; border: 2px solid #27272a; color: white; padding: 15px 10px; border-radius: 12px; cursor: pointer; font-size: 0.8rem; transition: 0.2s; min-height: 80px; display: flex; align-items: center; justify-content: center; line-height: 1.4; text-align: center; }
        .choice-btn.active { border-color: var(--accent-l); background: rgba(99, 102, 241, 0.1); }

        .analyze-btn { width: 100%; max-width: 300px; background: white; color: black; border: none; padding: 20px; border-radius: 50px; font-size: 1rem; font-weight: 900; cursor: pointer; display: block; margin: 0 auto 100px; }
        .analyze-btn:disabled { background: #27272a; color: #52525b; }

        #result-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; overflow-y: auto; padding: 20px 10px; box-sizing: border-box;}
        #capture-area { background: #fff; color: #000; border-radius: 32px; overflow: hidden; width: 100%; max-width: 400px; margin: 0 auto; position: relative;}
        .card-top { background: #000; padding: 30px 20px; text-align: center; color: white; }
        .card-content { padding: 30px 25px; text-align: center; }
        .res-type-badge { display: inline-block; font-size: 0.65rem; font-weight: 800; padding: 4px 12px; border: 1px solid #000; border-radius: 4px; margin-bottom: 10px; text-transform: uppercase; color: #000; }
        .res-title { font-size: 1.4rem; font-weight: 900; color: #000; margin-bottom: 10px; line-height: 1.2; }
        .res-desc { font-size: 0.85rem; color: #4b5563; margin-bottom: 30px; line-height: 1.6; }

        .match-section-title { font-size: 0.7rem; font-weight: 800; color: #9ca3af; letter-spacing: 1px; margin-bottom: 8px; }
        .best-artist-display { margin-bottom: 25px; padding: 20px; background: #f9fafb; border-radius: 20px; }
        .best-name { font-size: 1.6rem; font-weight: 900; color: #000; margin-bottom: 8px; display: block; }
        .artist-tags-container { display: flex; justify-content: center; gap: 4px; margin-bottom: 12px; flex-wrap: wrap; }
        .artist-tag-badge { font-size: 0.55rem; font-weight: 900; padding: 2px 8px; border-radius: 4px; background: #000; color: #fff; text-transform: uppercase; }
        
        .yt-link { font-size: 0.75rem; text-decoration: none; color: #ff0000; font-weight: 800; display: flex; align-items: center; justify-content: center; gap: 4px; }
        .other-artists-box { display: flex; flex-wrap: wrap; gap: 6px; justify-content: center; border-top: 1px solid #eee; padding-top: 20px; margin-top: 10px; }
        .artist-chip { background: #f3f4f6; padding: 5px 12px; border-radius: 50px; font-size: 0.7rem; font-weight: 700; color: #1f2937; border: 1px solid #e5e7eb; }

        .action-container { width: 100%; max-width: 400px; margin: 20px auto; display: flex; flex-direction: column; gap: 12px; }
        .save-btn { background: var(--accent-l); color: white; border: none; padding: 18px; border-radius: 16px; font-weight: 800; cursor: pointer; }
        .retry-text { text-align: center; color: var(--text-dim); font-size: 0.7rem; margin-top: 20px; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>MUSIC DNA</h1>
        <p class="sub-guide">Ê∑±„ÅèËÄÉ„Åà„Åö„ÄÅÁõ¥ÊÑü„ÅßÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ</p>
        <div id="loading-status">Loading Data...</div>
    </header>
    <div class="question-wrapper" id="q-list"></div>
    <button id="analyze-btn" class="analyze-btn" disabled onclick="showResult()">ÂàÜÊûê„ÇíÈñãÂßã„Åô„Çã</button>
</div>

<div id="result-overlay">
    <div id="capture-area">
        <div class="card-top">
            <div style="font-size: 0.5rem; letter-spacing: 3px; color: #71717a;">MUSIC DNA REPORT</div>
            <div style="font-size: 1rem; font-weight: 900; margin-top: 5px;">CERTIFIED LISTENER</div>
        </div>
        <div class="card-content">
            <div id="res-type" class="res-type-badge">-</div>
            <div id="res-title" class="res-title">-</div>
            <p id="res-desc" class="res-desc">-</p>
            
            <div class="best-artist-display">
                <div class="match-section-title">‰∏ÄÁï™Âêà„ÅÜ„Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàÔºÅ</div>
                <div id="best-match-tags" class="artist-tags-container"></div>
                <div id="best-match-name" class="best-name">-</div>
                <a id="yt-search-btn" href="#" target="_blank" class="yt-link">‚ñ∂ YouTube„ÅßËÅ¥„Åè</a>
            </div>

            <div class="other-section">
                <div class="match-section-title">‰ªñ„ÅÆ„Åä„Åô„Åô„ÇÅ</div>
                <div id="other-match-list" class="other-artists-box"></div>
            </div>
        </div>
    </div>
    <div class="action-container">
        <button class="save-btn" onclick="saveAsImage()">üì∏ ÁµêÊûú„ÇíÁîªÂÉè„Åß‰øùÂ≠ò„Åô„Çã</button>
        <div class="retry-text" onclick="location.reload()">„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë®∫Êñ≠„Åô„Çã</div>
    </div>
</div>

<script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRRyt_I_8kDlfPnMSxsVSYBcytr3ur76vs7xmF30t01RFQUkAlULzF8P1oLlsFdLcyMZrQCMj3PAANV/pub?output=csv';
    
    const questions = [
        { id:0, a: "Âº∑„ÅÑÈü≥„Åß‰∏ÄÊ∞ó„Å´Ê∞óÊåÅ„Å°„ÇíËß£Êîæ„Åó„Åü„ÅÑ", b: "ÊÑüÊÉÖ„Å´ÂØÑ„ÇäÊ∑ª„Å£„Å¶„Åè„Çå„ÇãÊõ≤„Å´Ë∫´„ÇíÈ†ê„Åë„Åü„ÅÑ", catA: "energy", catB: "deep" },
        { id:1, a: "Â†¥„ÅÆÁÜ±Èáè„Åî„Å®Èü≥Ê•Ω„ÇíÊµ¥„Å≥„Åü„ÅÑ", b: "Èü≥„ÅÆÁæé„Åó„Åï„Å´Èùô„Åã„Å´Êµ∏„Çä„Åü„ÅÑ", catA: "energy", catB: "aesthetic" },
        { id:2, a: "Áü•„Çâ„Å™„ÅÑÈü≥Ê•Ω„Å´Âá∫‰ºö„ÅÜ„Å®„ÉØ„ÇØ„ÉØ„ÇØ„Åô„Çã", b: "Â•Ω„Åç„Å™Èü≥Ê•Ω„ÇíÁπ∞„ÇäËøî„ÅóËÅ¥„ÅèÊñπ„ÅåËêΩ„Å°ÁùÄ„Åè", catA: "dig", catB: "aesthetic" },
        { id:3, a: "ÊßãÊàê„ÇÑÂ±ïÈñã„ÅÆÂ∑ß„Åï„Å´„Çæ„ÇØ„ÉÉ„Å®„Åô„Çã", b: "ËÄÉ„ÅàËæº„Åæ„Åö„ÄÅ„Åù„ÅÆÁû¨Èñì„ÅÆÂã¢„ÅÑ„ÅßÊ•Ω„Åó„Åø„Åü„ÅÑ", catA: "skill", catB: "energy" },
        { id:4, a: "‰∏Ä„Å§‰∏Ä„Å§„ÅÆÈü≥„ÇÑÊºîÂ•è„ÇíÁ¥∞„Åã„ÅèËÅ¥„Åç„Åü„ÅÑ", b: "ÂÖ®‰Ωì„ÅÆÈõ∞Âõ≤Ê∞ó„ÅåÂøÉÂú∞„Çà„Åë„Çå„Å∞„Åù„Çå„Åß„ÅÑ„ÅÑ", catA: "skill", catB: "aesthetic" },
        { id:5, a: "ÊúÄÂàù„ÅÆÊï∞Áßí„ÅßÂÆåÊàêÂ∫¶„ÇíÊÑü„Åò„Åü„ÅÑ", b: "ËÅ¥„ÅçÁµÇ„Çè„Å£„ÅüÂæå„ÅÆ‰ΩôÈüª„ÇíÂ§ß‰∫ã„Å´„Åó„Åü„ÅÑ", catA: "skill", catB: "aesthetic" },
        { id:6, a: "ÊÑüÊÉÖ„Åå„ÇÄ„ÅçÂá∫„Åó„ÅÆÊ≠å„Å´ÂÖ±ÊÑü„Åó„Åü„ÅÑ", b: "Ëá™Áî±„Å™Áô∫ÊÉ≥„ÇÑ„Çµ„Ç¶„É≥„Éâ„ÇíÂèñ„ÇäÂÖ•„Çå„ÅüÊõ≤„ÇíËÅ¥„Åç„Åü„ÅÑ", catA: "deep", catB: "dig" },
        { id:7, a: "Ëá™ÂàÜ„ÅÆÊÑüË¶ö„Å´Âà∫„Åï„ÇãÈü≥Ê•Ω„ÇíË¶ã„Å§„Åë„Åü„ÅÑ", b: "Ê¥óÁ∑¥„Åï„Çå„Åü„Çª„É≥„Çπ„ÇíÊÑü„Åò„ÇãÈü≥„Å´ÊÉπ„Åã„Çå„Çã", catA: "dig", catB: "aesthetic" },
        { id:8, a: "Êñ∞„Åó„ÅÑÂà∫ÊøÄ„ÇÑÊú™Áü•„ÅÆ„Ç∏„É£„É≥„É´„ÇíÊé¢„Åó„Åü„ÅÑ", b: "ÊºîÂ•è„ÇÑ„Éó„É¨„Ç§„ÅÆÂáÑ„Åï„ÇíÂë≥„Çè„ÅÑ„Åü„ÅÑ", catA: "dig", catB: "skill" },
        { id:9, a: "Ê∑±Â§ú„Å´‰∏Ä‰∫∫„ÅßÈùô„Åã„Å´Êµ∏„ÇãÈü≥Ê•Ω", b: "ÊòºÈñì„Å´ËÉå‰∏≠„ÇíÊäº„Åó„Å¶„Åè„Çå„ÇãÈü≥Ê•Ω", catA: "deep", catB: "energy" },
        { id:10, a: "Â∞è„Åï„ÅÑ„É©„Ç§„Éñ„Éè„Ç¶„Çπ„ÅßÊ•Ω„Åó„ÇÄÈü≥Ê•Ω„ÅåÂ•Ω„Åç", b: "Â§ß„Åç„Å™‰∏Ä‰ΩìÊÑü„ÇíÁîü„ÇÄÈü≥Ê•Ω„ÅåÂ•Ω„Åç", catA: "dig", catB: "energy" },
        { id:11, a: "‰∏ÄË≤´„Åó„ÅüÁæéÊÑèË≠ò„ÇÑ‰∏ñÁïåË¶≥„ÇíÊÑü„Åò„Åü„ÅÑ", b: "‰∫àÊ∏¨„Åß„Åç„Å™„ÅÑÂ±ïÈñã„ÇÑÂ§â„Å™Èü≥„Å´ÊÉπ„Åã„Çå„Çã", catA: "aesthetic", catB: "dig" },
        { id:12, a: "‰∏ÄÊ∞ó„Å´ÂÖÉÊ∞ó„Çí„ÉÅ„É£„Éº„Ç∏„Åó„Åü„ÅÑ", b: "Èùô„Åã„ÅßÂøÉÂú∞„Çà„ÅÑÊôÇÈñì„ÇíÈÅé„Åî„Åó„Åü„ÅÑ", catA: "energy", catB: "aesthetic" },
        { id:13, a: "ÊÑüÊÉÖ„ÇíÁõ¥Êé•Êè∫„Åï„Å∂„Çâ„Çå„ÇãÁû¨Èñì„ÅåÂ§ß‰∫ã", b: "Êõ≤„ÅÆÊßãÊàê„ÇÑÂÆåÊàêÂ∫¶„Å´ÊÑüÂãï„Åó„Åü„ÅÑ", catA: "deep", catB: "skill" },
        { id:14, a: "„Åæ„Å†Áü•„Çâ„Çå„Å¶„ÅÑ„Å™„ÅÑÊÑü„Åò„Åå„Åü„Åæ„Çâ„Å™„ÅÑ", b: "„Åø„Çì„Å™„ÅßÂÖ±Êúâ„Åß„Åç„ÇãÁÜ±„Åï„Åå„Åü„Åæ„Çâ„Å™„ÅÑ", catA: "dig", catB: "energy" }
    ];

    const titleMap = {
        "energy_dig": ["ÊúÄÂâçÁ∑ö„ÇíÁÑº„ÅèÁàÜÈü≥„Éè„É≥„Çø„Éº", "Âà∫ÊøÄ„Å®ÁÜ±ÁãÇ„ÇíÊ±Ç„ÇÅ„Å¶„ÄÅÊú™Áü•„ÅÆÊâçËÉΩ„ÇíÊéò„ÇäÁ∂ö„Åë„ÇãÈñãÊãìËÄÖ„ÄÇ"],
        "energy_aesthetic": ["ÂÖâ„ÇäËºù„Åè„Çπ„ÉÜ„Éº„Ç∏„ÅÆÁõÆÊíÉËÄÖ", "Ê¥æÊâã„Å™„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇÑÊ¥óÁ∑¥„Åï„Çå„ÅüÁæéÂ≠¶„ÇíÊÑõ„Åô„Çã„ÄÇ"],
        "energy_skill": ["Á≤æÂØÜ„Å´ÁãÇ„ÅÜÊÉÖÁÜ±„ÅÆ„É°„Ç´„Éã„Ç∫„É†", "ÂÆåÁíß„Å´„Ç≥„É≥„Éà„É≠„Éº„É´„Åï„Çå„ÅüÁãÇÊ∞ó„Å®„ÄÅÂúßÂÄíÁöÑ„Å™ÊºîÂ•èÊäÄË°ì„ÇíÊÑõ„Åô„Çã„ÄÇ"],
        "energy_deep": ["È≠Ç„ÇíÈúá„Çè„Åõ„ÇãÊÉÖÁÜ±„ÅÆ‰ª£ÂºÅËÄÖ", "ÂøÉ„ÅÆÂè´„Å≥„Çí‰ª£ÂºÅ„Åó„Å¶„Åè„Çå„Çã„Çà„ÅÜ„Å™„ÄÅÁÜ±„ÅÑ„É°„ÉÉ„Çª„Éº„Ç∏ÊÄß„ÇíÈáçË¶ñ„Åô„Çã„ÄÇ"],
        "dig_aesthetic": ["„Éà„É¨„É≥„Éâ„ÅÆÂ¢ÉÁïå„ÇíÊ≠©„ÅèÂØ©ÁæéÂÆ∂", "Â∏∏„Å´ÊúÄÂÖàÁ´Ø„ÅÆ„Çª„É≥„Çπ„ÇíÊåÅ„Å°„ÄÅ„Ç∏„É£„É≥„É´„É¨„Çπ„Å´„Äå‰ªä„Åã„Å£„Åì„ÅÑ„ÅÑÈü≥„Äç„Çí„Ç≠„É£„ÉÉ„ÉÅ„Åô„Çã„ÄÇ"],
        "dig_skill": ["Êú™Ë∏è„ÅÆË≠úÈù¢„ÇíËß£„ÅèÈü≥„ÅÆËß£ÊûêÂÆò", "Ë™∞„ÇÇÁúü‰ºº„Åß„Åç„Å™„ÅÑÁã¨Ëá™„ÅÆÊºîÂ•èÊäÄË°ì„ÇÑ„ÄÅÁï∞Ë≥™„Å™„Çµ„Ç¶„É≥„ÉâÊßãÊàê„Å´Âø´ÊÑü„ÇíË¶ö„Åà„Çã„ÄÇ"],
        "dig_deep": ["„Éç„ÉÉ„Éà„ÅÆÊµ∑Â∫ï„ÇíÊºÇ„ÅÜÊÑüÊÉÖ„ÅÆË¶≥Ê∏¨ËÄÖ", "Ëá™ÂàÜ„Å†„Åë„ÅÆÂ≠§Áã¨„Å´ÂØÑ„ÇäÊ∑ª„ÅÜ„ÄÅ„Åæ„Å†Ë¶ã„Å¨Ê≠å„Çí„Éç„ÉÉ„Éà„ÅÆÂ∫ï„ÅßÊé¢„ÅóÁ∂ö„Åë„Çã„ÄÇ"],
        "aesthetic_skill": ["ÂÆåÁíß„Å™‰ΩôÁôΩ„ÇíÂâµ„ÇãÈü≥Èüø„Ç¢„Éº„Ç≠„ÉÜ„ÇØ„Éà", "Ê¥óÁ∑¥„Åï„Çå„ÅüÁ©∫Ê∞óÊÑü„Å®„ÄÅ„Åù„Çå„ÇíÊîØ„Åà„ÇãÈ´òÂ∫¶„Å™ÊäÄÂ∑ß„ÇíÊÑõ„Åô„Çã„ÄÇ"],
        "aesthetic_deep": ["ÊúàÂ§ú„Å´Ê≤à„ÇÄÁæéÂ≠¶„ÅÆË©©‰∫∫", "Áæé„Åó„ÅÑË®ÄËëâÈÅ∏„Å≥„Å®Á∂∫È∫ó„Å™ÊóãÂæã„Å†„Åë„Å´Êµ∏„Çä„ÄÅËá™ÂàÜ„Å†„Åë„ÅÆ‰∏ñÁïå„Çí‰Ωú„Çã„ÄÇ"],
        "skill_deep": ["Ê∑±Ê∑µ„ÇíË®≠Ë®à„Åô„ÇãÈü≥ÈüøÂì≤Â≠¶ËÄÖ", "Áâ©Ë™ûÊÄß„ÇíÂ§ß‰∫ã„Å´„Åó„Å§„Å§„ÄÅ„Åù„ÅÆË£è„Å´„ÅÇ„ÇãË§áÈõë„Å™Èü≥„ÅÆÈáç„Å™„Çä„ÇíÂàÜÊûê„Åô„Çã„ÄÇ"]
    };

    let artistMaster = [];
    let answers = new Array(questions.length).fill(null);

    async function init() {
        try {
            const res = await fetch(SHEET_URL);
            const csvText = await res.text();
            const rows = csvText.split(/\r?\n/).slice(1);
            artistMaster = rows.map(row => {
                const cols = row.split(',');
                if (cols.length < 2) return null;
                const tags = cols[1].toLowerCase().split(/[,|„ÄÅ\s]/).map(t => t.trim());
                return { name: cols[0].trim().replace(/^"|"$/g, ''), tags: tags };
            }).filter(a => a && a.name);
            document.getElementById('loading-status').innerText = `‚úÖ ${artistMaster.length} Artists Synced`;
        } catch(e) {
            document.getElementById('loading-status').innerText = `‚ùå Sync Failed`;
        }
        render();
    }

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function render() {
        const list = document.getElementById('q-list');
        const shuffledQuestions = shuffle([...questions]);
        shuffledQuestions.forEach((q, i) => {
            const d = document.createElement('div');
            d.className = 'q-container';
            d.innerHTML = `<span class="q-header">QUESTION ${i+1}</span><div class="choice-group">
                <button class="choice-btn" onclick="sel(${q.id},'A',this)">${q.a}</button>
                <button class="choice-btn" onclick="sel(${q.id},'B',this)">${q.b}</button>
            </div>`;
            list.appendChild(d);
        });
    }

    function sel(id, t, b) {
        answers[id] = t;
        Array.from(b.parentElement.children).forEach(btn=>btn.classList.remove('active'));
        b.classList.add('active');
        if(!answers.includes(null)) document.getElementById('analyze-btn').disabled = false;
    }

    function showResult() {
        let scores = {energy:0, deep:0, aesthetic:0, skill:0, dig:0};
        answers.forEach((ans, i) => scores[ans==='A' ? questions[i].catA : questions[i].catB]++);
        
        // --- Âà§ÂÆö„É≠„Ç∏„ÉÉ„ÇØ ---
        let netCount = 0;
        if(answers[6] === 'B') netCount++;
        if(answers[10] === 'A') netCount++;
        if(answers[14] === 'A') netCount++;
        const isNet = netCount >= 2;
        const isLoud = (answers[0] === 'A' && answers[6] === 'A');
        const isIdol = (answers[1] === 'A' && answers[11] === 'A');

        const sorted = Object.entries(scores).sort((a,b)=>b[1]-a[1]);
        const t1 = sorted[0][0], t2 = sorted[1][0];
        
        document.getElementById('res-type').innerText = `${t1.toUpperCase()}Âûã / ${t2.toUpperCase()}Âûã`;
        const res = titleMap[`${t1}_${t2}`] || titleMap[`${t2}_${t1}`] || ["Èü≥Ê•Ω„ÅÆÂÜíÈô∫ÂÆ∂", "Êñ∞„Åó„ÅÑÈü≥„Å®„ÅÆÂá∫‰ºö„ÅÑ„ÇíÊ•Ω„Åó„ÇÄ„ÄÇ"];
        document.getElementById('res-title').innerText = res[0];
        document.getElementById('res-desc').innerText = res[1];

        let list = artistMaster.map(a => {
            let pts = 0;
            if(a.tags.includes(t1)) pts += 10;
            if(a.tags.includes(t2)) pts += 5;
            if(isNet && a.tags.includes('internet')) pts += 20;
            if(isLoud && a.tags.includes('loud')) pts += 15;
            if(isIdol && a.tags.includes('idol')) pts += 15;
            return { ...a, score: pts };
        });

        list = shuffle(list).sort((a,b) => b.score - a.score);
        const best = list[0];
        const others = list.slice(1, 6);

        // „Éô„Çπ„Éà„Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàË°®Á§∫Ôºà„Çø„Ç∞„Éê„ÉÉ„Ç∏‰ªò„ÅçÔºâ
        document.getElementById('best-match-name').innerText = best.name;
        const displayTags = best.tags.filter(t => ['idol','loud','internet','skill','energy','deep','aesthetic','dig'].includes(t));
        document.getElementById('best-match-tags').innerHTML = displayTags.map(t => `<span class="artist-tag-badge">${t}</span>`).join('');
        
        document.getElementById('yt-search-btn').href = `https://www.youtube.com/results?search_query=${encodeURIComponent(best.name)}`;
        document.getElementById('other-match-list').innerHTML = others.map(a => `<div class="artist-chip">${a.name}</div>`).join('');

        document.getElementById('result-overlay').style.display = 'block';
        window.scrollTo(0,0);
    }

    async function saveAsImage() {
        const area = document.getElementById('capture-area');
        const canvas = await html2canvas(area, { backgroundColor: '#000', scale: 2 });
        const link = document.createElement('a');
        link.download = 'MUSIC_DNA_RESULT.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    }

    init();
</script>
</body>
</html>

    init();
</script>
</body>
</html>
